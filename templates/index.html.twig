{% extends 'base.html.twig' %}

{% block title %}
    <!-- D√©finition du titre de la page d'accueil -->
    {{ variableTitre }}
{% endblock %}

{% block stylesheets %}
    <!-- Feuilles de style pour la page d'accueil et le formulaire de connexion -->
    <link rel="stylesheet" href="{{ asset('Styles/style-accueil.css') }}">
    <link rel="stylesheet" href="{{ asset('Styles/login_style.css') }}">
{% endblock %}

{% block javascripts %}
    <!-- Script de v√©rification du formulaire de connexion -->
    <script src="{{ asset('Scripts/verif_form.js') }}" defer ></script>
    <!-- Script pour ouvrir/fermer le menu lat√©ral de connexion -->
    <script src="{{ asset('Scripts/login_menu.js') }}" defer></script>
{% endblock %}

{% block body %}
<div class="container">
    {% if error %}
        <!-- Affichage d'un message d'erreur si la connexion √©choue -->
        <div class="error" id="errorMessage">{{ error.messageKey|trans(error.messageData, 'security') }}</div>
    {% endif %}

    {% if not is_granted('IS_AUTHENTICATED_FULLY') %}
        <!-- Bouton pour ouvrir le menu lat√©ral de connexion -->
        <button class="menu-button" onclick="toggleMenu()">Connexion</button>

        <!-- Menu lat√©ral pour la connexion -->
        <div id="side-menu" class="side-menu">
            <!-- Bouton pour fermer le menu lat√©ral -->
            <button class="close-button" onclick="toggleMenu()">√ó</button>
            <!-- Contenu du menu lat√©ral -->
            {% block login %}
                <!-- Formulaire de connexion -->
                <form id="formulaire_login" method="post" action="{{ path('app_login') }}">
                    <h1>Connexion</h1>
                    <div>
                        <label for="username">Email</label>
                        <br>
                        <input autofocus type="email" id="username" name="_username" value="{{ last_username }}" placeholder="Email" required autocomplete="email">
                    </div>
                    <br>
                    <div class="password-container">
                        <label for="password">Mot de passe</label>
                        <br>
                        <input type="password" id="password" name="_password" placeholder="Mot de passe" required autocomplete="current-password">
                        <span class="toggle-password" id="togglePassword">üëÅÔ∏è</span>
                    </div>
                    <br>
                    <!-- Jeton CSRF pour la s√©curit√© -->
                    <input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">
                    <div>
                        <button type="submit" style="width:50%;">Se Connecter</button>
                    </div>
                </form>
                <br>
                <!-- Lien pour mot de passe oubli√© (popup humoristique) -->
                <div style="text-align: center;">
                    <a href="#" onclick="openForgotPasswordPopup()">Mot de passe oubli√© ?</a>
                </div>
                <div id="forgotPasswordPopup" class="popup" style="display: none;">
                    <div class="popup-box">
                        <span class="close" onclick="closeForgotPasswordPopup()">&times;</span>
                        <h2>Dommage!</h2>
                        <p>Tant pis pour vous, il fallait s'en souvenir (ou le noter)...</p>
                    </div>
                </div>
                <div id="secondPopup" class="popup" style="display: none;">
                    <div class="popup-box">
                        <span class="close" onclick="closeSecondPopup()">&times;</span>
                        <h2>Encore l√† ?</h2>
                        <p>Peut-√™tre devriez-vous contacter l'administrateur pour r√©cup√©rer votre mot de passe.</p>
                    </div>
                </div>
            {% endblock %}
        </div>
    {% endif %}

    <div class="main-content">
        <h1>Plateforme p√©dagogique</h1>
        <!-- Affichage de trois blocs d'information en grille -->
        <div class="grid-container">
            <div>
                <img src="{{ asset('Images/architecture.webp') }}" alt="architecture" class="grid-container-img">
                <h4>Read me</h4>
            </div>
            <div>
                <a href="https://www.utbm.fr/"><img src="{{ asset('Images/utbm_montbe.webp') }}" alt="batiment de l'utbm" class="grid-container-img"></a>
                <h4><a href="https://www.utbm.fr/">D√©couvrir l'UTBM</a></h4>
            </div>
            <div>
                <a href="https://bibliotheque.utbm.fr/"><img src="{{ asset('Images/semafort.jpg') }}" alt="logo semafort"
                                                             class="grid-container-img"></a>
                <h4><a href="https://bibliotheque.utbm.fr/">Biblioth√®que</a></h4>
            </div>
        </div>
    </div>
</div>
{% endblock %}
